CREATE TABLE case
(
    "id"                INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "proband_id"        INTEGER REFERENCES "patient" ("id")   NOT NULL,
    "project_id"        INTEGER REFERENCES "project" ("id")   NOT NULL,
    "type"              TEXT REFERENCES "case_types" ("code") NOT NULL,
    "status"            TEXT                                  NOT NULL REFERENCES "statuses" ("code"),
    "primary_condition" TEXT,
    "panel_id"          INTEGER,
    "request_id"        INTEGER REFERENCES "request" ("id"),
    "performer_lab_id"  INTEGER REFERENCES "organization" ("id"),
    "note"              TEXT,
    "created_on"        TIMESTAMP                             NOT NULL,
    "updated_on"        TIMESTAMP                             NOT NULL
);

CREATE INDEX IF NOT EXISTS idx_case_proband_id ON "case" ("proband_id");
CREATE INDEX IF NOT EXISTS idx_case_project_id ON "case" ("project_id");
CREATE INDEX IF NOT EXISTS idx_case_type ON "case" ("type");
CREATE INDEX IF NOT EXISTS idx_case_status ON "case" ("status");
CREATE INDEX IF NOT EXISTS idx_case_primary_condition ON "case" ("primary_condition");
CREATE INDEX IF NOT EXISTS idx_case_panel_id ON "case" ("panel_id");
CREATE INDEX IF NOT EXISTS idx_case_created_on ON "case" ("created_on");
