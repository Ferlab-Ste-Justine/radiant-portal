import{j as l}from"./jsx-runtime-D_zvdyIk.js";import{r as i}from"./index-DUAV1Q2A.js";import{f as he}from"./index-DhvbgntC.js";import{a as W}from"./index-B-lxVbXh.js";import{u as ve,d as be,e as xe,V as ge,a as we,c as G,b as ye}from"./useDebounce-D_i8yEaw.js";import{B as Ne}from"./badge-HgGuUB4c.js";import{c as b}from"./utils-BNf5BS2b.js";import{S as je}from"./skeleton-D8I-6WeW.js";import{X as $}from"./dialog-3ysF2mkX.js";import{C as Oe}from"./check-D0WsHlur.js";import"./v4-CtRu48qb.js";import"./index-BiAv9jRD.js";import"./index-aKoabQ1X.js";import"./index-VDvXe9nZ.js";import"./index-CqVsPxxY.js";import"./Combination-BCojpehm.js";import"./index-5epIGEb9.js";import"./index-C66Dxnp2.js";import"./createLucideIcon-DirO1-NP.js";function R(c,s){if(c.length===0)return{};if(!s)return{"":c};const o={};return c.forEach(m=>{const p=m[s]||"";o[p]||(o[p]=[]),o[p].push(m)}),o}function Q(c,s){return s.filter(o=>c.includes(o.value))}function Te(c,s){for(const[,o]of Object.entries(c))if(o.some(m=>s.find(p=>p.value===m.value)))return!0;return!1}function k({value:c,onChange:s,placeholder:o,defaultOptions:m=[],options:p,debounceDelay:se=500,onSearch:f,onSearchSync:V,emptyIndicator:z,maxSelected:K=Number.MAX_SAFE_INTEGER,onMaxSelected:y,hidePlaceholderWhenSelected:B,disabled:N,groupBy:x,className:re,badgeClassName:ne,selectFirstItem:ie=!0,creatable:S=!1,triggerSearchOnFocus:C=!1,commandProps:n,inputProps:u,hideClearAllButton:ue=!1,ref:oe}){const d=i.useRef(null),[g,A]=i.useState(!1),[ce,X]=i.useState(!1),[H,J]=i.useState(!1),L=i.useRef(null),[a,j]=i.useState(Q(c||[],m)),[O,D]=i.useState(R(m,x)),[v,F]=i.useState(""),w=ve(v,se);i.useImperativeHandle(oe,()=>({selectedValue:[...a],input:d.current,focus:()=>{var e;return(e=d==null?void 0:d.current)==null?void 0:e.focus()},reset:()=>j([])}),[a]);const T=e=>{L.current&&!L.current.contains(e.target)&&d.current&&!d.current.contains(e.target)&&(A(!1),d.current.blur())},q=i.useCallback(e=>{const t=a.filter(r=>r.value!==e.value);j(t),s==null||s(t.map(r=>r.value))},[s,a]),de=i.useCallback(e=>{const t=d.current;t&&((e.key==="Delete"||e.key==="Backspace")&&t.value===""&&a.length>0&&(a[a.length-1].fixed||q(a[a.length-1])),e.key==="Escape"&&t.blur())},[q,a]);i.useEffect(()=>(g?(document.addEventListener("mousedown",T),document.addEventListener("touchend",T)):(document.removeEventListener("mousedown",T),document.removeEventListener("touchend",T)),()=>{document.removeEventListener("mousedown",T),document.removeEventListener("touchend",T)}),[g]),i.useEffect(()=>{c&&m.length>0&&j(Q(c,m))},[c,m]),i.useEffect(()=>{if(!p||f)return;const e=R(p||[],x);JSON.stringify(e)!==JSON.stringify(O)&&D(e)},[m,p,x,f,O]),i.useEffect(()=>{const e=()=>{const r=V==null?void 0:V(w);D(R(r||[],x))};(async()=>{!V||!g||(C&&e(),w&&e())})()},[w,x,g,C]),i.useEffect(()=>{const e=async()=>{J(!0);const r=await(f==null?void 0:f(w));D(R(r||[],x)),J(!1)};(async()=>{!f||!g||(C&&await e(),w&&await e())})()},[w,x,g,C]);const me=()=>{if(!S||Te(O,[{value:v,label:v}])||a.find(t=>t.value===v))return;const e=l.jsx(G,{value:v,className:"cursor-pointer",onMouseDown:t=>{t.preventDefault(),t.stopPropagation()},onSelect:t=>{if(a.length>=K){y==null||y(a.length);return}F("");const r=[...a,{value:t,label:t}];j(r),s==null||s(r.map(_=>_.value))},children:`Create "${v}"`});if(!f&&v.length>0||f&&w.length>0&&!H)return e},fe=i.useCallback(()=>f&&!S&&Object.keys(O).length===0?l.jsx("div",{className:"p-2 py-4 text-center text-sm",children:"No data"}):l.jsx(be,{children:z||l.jsx("div",{className:"text-center text-sm",children:"No data"})}),[S,z,f,O]),pe=i.useCallback(()=>{if(n!=null&&n.filter)return n.filter;if(S)return(e,t)=>e.toLowerCase().includes(t.toLowerCase())?1:-1},[S,n==null?void 0:n.filter]);return l.jsxs(xe,{ref:L,...n,onKeyDown:e=>{var t;de(e),(t=n==null?void 0:n.onKeyDown)==null||t.call(n,e)},className:b("h-auto overflow-visible bg-background",n==null?void 0:n.className),shouldFilter:(n==null?void 0:n.shouldFilter)!==void 0?n.shouldFilter:!f,filter:pe(),children:[l.jsx("div",{className:b("flex min-h-10 rounded-md border border-input text-base md:text-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring",{"px-3 py-2":a.length!==0,"cursor-text":!N&&a.length!==0},re),onClick:()=>{var e;N||(e=d==null?void 0:d.current)==null||e.focus()},children:l.jsxs("div",{className:"relative flex flex-1 flex-wrap gap-1",children:[a.map(e=>l.jsxs(Ne,{size:"xs",variant:"default",className:b("rounded-lg","data-[disabled]:bg-muted-foreground data-[disabled]:text-muted data-[disabled]:hover:bg-muted-foreground","data-[fixed]:bg-muted-foreground data-[fixed]:text-muted data-[fixed]:hover:bg-muted-foreground",ne),"data-fixed":e.fixed,"data-disabled":N||void 0,children:[e.label,l.jsx("button",{className:b("ml-1 rounded-full outline-none ring-offset-background focus:ring-2 focus:ring-ring hover:cursor-pointer",(N||e.fixed)&&"hidden"),onKeyDown:t=>{t.key==="Enter"&&q(e)},onMouseDown:t=>{t.preventDefault(),t.stopPropagation()},onClick:()=>q(e),children:l.jsx($,{size:12,className:"text-primary-foreground"})})]},e.value)),l.jsx(ge.Input,{...u,ref:d,value:v,disabled:N,onValueChange:e=>{var t;F(e),(t=u==null?void 0:u.onValueChange)==null||t.call(u,e)},onBlur:e=>{var t;ce||A(!1),(t=u==null?void 0:u.onBlur)==null||t.call(u,e)},onFocus:e=>{var t;A(!0),(t=u==null?void 0:u.onFocus)==null||t.call(u,e)},placeholder:B&&a.length!==0?"":o,className:b("flex-1 bg-transparent outline-none placeholder:text-muted-foreground",{"w-full":B,"px-3 py-2":a.length===0,"ml-1":a.length!==0},u==null?void 0:u.className)}),l.jsx("button",{type:"button",onClick:()=>{j(a.filter(e=>e.fixed)),s==null||s(a.filter(e=>e.fixed).map(e=>e.value))},className:b("absolute right-0 h-[26px] p-0",(ue||N||a.length<1||a.filter(e=>e.fixed).length===a.length)&&"hidden"),children:l.jsx($,{size:18,className:""})})]})}),l.jsx("div",{className:b("relative",g?"block":"hidden"),children:l.jsx(we,{className:"absolute top-1 z-10 w-full rounded-md border border-border bg-popover text-popover-foreground shadow-md outline-none animate-in fade-in-0 zoom-in-95",onMouseLeave:()=>{X(!1)},onMouseEnter:()=>{X(!0)},onMouseUp:()=>{var e;(e=d==null?void 0:d.current)==null||e.focus()},children:H?l.jsx("div",{className:"p-1",children:l.jsx(je,{className:"h-8 w-full"})}):l.jsxs(l.Fragment,{children:[fe(),me(),!ie&&l.jsx(G,{value:"-",className:"hidden"}),Object.entries(O).map(([e,t])=>l.jsx(ye,{heading:e,className:"h-full overflow-auto",children:l.jsx(l.Fragment,{children:t.map(r=>{var U;const _=(U=a.map(h=>h.value))==null?void 0:U.includes(r.value);return l.jsxs(G,{value:r.label,disabled:r.disable,onMouseDown:h=>{h.preventDefault(),h.stopPropagation()},onSelect:()=>{if(a.length>=K){y==null||y(a.length);return}F("");let h=[];a.find(E=>E.value===r.value)?h=a.filter(E=>E.value!==r.value):h=[...a,r],j(h),s==null||s(h.map(E=>E.value))},className:b("cursor-pointer",r.disable&&"cursor-default text-muted-foreground"),children:[l.jsx("span",{className:"flex-1",children:r.label}),_?l.jsx(Oe,{className:"w-4"}):null]},r.value)})})},e))]})})})]})}k.displayName="MultipleSelector";k.__docgenInfo={description:"",methods:[{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"reset",docblock:null,modifiers:[],params:[],returns:null}],displayName:"MultipleSelector",props:{ref:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<MultipleSelectorRef>",elements:[{name:"MultipleSelectorRef"}]},description:""},value:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},defaultOptions:{required:!1,tsType:{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"},description:"",defaultValue:{value:"[]",computed:!1}},options:{required:!1,tsType:{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"},description:"manually controlled options"},placeholder:{required:!1,tsType:{name:"string"},description:""},emptyIndicator:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Empty component."},debounceDelay:{required:!1,tsType:{name:"number"},description:"Debounce time for async search. Only work with `onSearch`.",defaultValue:{value:"500",computed:!1}},triggerSearchOnFocus:{required:!1,tsType:{name:"boolean"},description:"Only work with `onSearch` prop. Trigger search when `onFocus`.\nFor example, when user click on the input, it will trigger the search to get initial options.",defaultValue:{value:"false",computed:!1}},onSearch:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => Promise<MultiSelectorOption[]>",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Promise",elements:[{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"}],raw:"Promise<MultiSelectorOption[]>"}}},description:"async search"},onSearchSync:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => MultiSelectorOption[]",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"}}},description:`sync search. This search will not showing loadingIndicator.
The rest props are the same as async search.
i.e.: creatable, groupBy, delay.`},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(options: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"options"}],return:{name:"void"}}},description:""},maxSelected:{required:!1,tsType:{name:"number"},description:"Limit the maximum number of selected options.",defaultValue:{value:"Number.MAX_SAFE_INTEGER",computed:!0}},onMaxSelected:{required:!1,tsType:{name:"signature",type:"function",raw:"(maxLimit: number) => void",signature:{arguments:[{type:{name:"number"},name:"maxLimit"}],return:{name:"void"}}},description:"When the number of selected options exceeds the limit, the onMaxSelected will be called."},hidePlaceholderWhenSelected:{required:!1,tsType:{name:"boolean"},description:"Hide the placeholder when there are options selected."},disabled:{required:!1,tsType:{name:"boolean"},description:""},groupBy:{required:!1,tsType:{name:"string"},description:"Group the options base on provided key."},className:{required:!1,tsType:{name:"string"},description:""},badgeClassName:{required:!1,tsType:{name:"string"},description:""},selectFirstItem:{required:!1,tsType:{name:"boolean"},description:`First item selected is a default behavior by cmdk. That is why the default is true.
This is a workaround solution by add a dummy item.

@reference: https://github.com/pacocoursey/cmdk/issues/171`,defaultValue:{value:"true",computed:!1}},creatable:{required:!1,tsType:{name:"boolean"},description:"Allow user to create option when there is no option matched.",defaultValue:{value:"false",computed:!1}},commandProps:{required:!1,tsType:{name:"ReactComponentPropsWithoutRef",raw:"React.ComponentPropsWithoutRef<typeof Command>",elements:[{name:"Command"}]},description:"Props of `Command`"},inputProps:{required:!1,tsType:{name:"Omit",elements:[{name:"ReactComponentPropsWithoutRef",raw:"React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>",elements:[{name:"CommandPrimitive.Input"}]},{name:"union",raw:'"value" | "placeholder" | "disabled"',elements:[{name:"literal",value:'"value"'},{name:"literal",value:'"placeholder"'},{name:"literal",value:'"disabled"'}]}],raw:`Omit<
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>,
  "value" | "placeholder" | "disabled"
>`},description:"Props of `CommandInput`"},hideClearAllButton:{required:!1,tsType:{name:"boolean"},description:"hide the clear all button.",defaultValue:{value:"false",computed:!1}}}};const Xe={title:"Base/Data Entry/Inputs/Multi Selector",component:k,args:{value:[],onChange:he(),placeholder:"Placeholder"}},le=[{label:"Nextjs",value:"Nextjs"},{label:"Vite",value:"vite"},{label:"Nuxt",value:"nuxt",disable:!0},{label:"Vue",value:"vue, disable: true",disable:!0},{label:"Remix",value:"remix"},{label:"Svelte",value:"svelte",disable:!0},{label:"Angular",value:"angular",disable:!0},{label:"Ember",value:"ember",disable:!0},{label:"React",value:"react"},{label:"Gatsby",value:"gatsby",disable:!0},{label:"Astro",value:"astro",disable:!0}],M={render:()=>{const[c,s]=i.useState(["Nextjs"]);return l.jsx(k,{value:c,onChange:o=>{s(o),W("onChange")(o)},className:"max-w-[300px]",placeholder:"Placeholder",commandProps:{className:"max-w-[300px]"},defaultOptions:le})}},I={render:()=>{const[c,s]=i.useState(["Nextjs"]);return l.jsx(k,{value:c,onChange:o=>{s(o),W("onChange")(o)},onSearch:async o=>(W("onSearch")(o),new Promise(m=>{setTimeout(()=>m(le),1e3)})),debounceDelay:300,className:"max-w-[300px]",placeholder:"Placeholder",commandProps:{className:"max-w-[300px]"}})}};var Y,Z,P;M.parameters={...M.parameters,docs:{...(Y=M.parameters)==null?void 0:Y.docs,source:{originalSource:`{
  render: () => {
    const [values, setValues] = useState<string[]>(["Nextjs"]);
    return <MultiSelector value={values} onChange={newValues => {
      setValues(newValues);
      action("onChange")(newValues);
    }} className="max-w-[300px]" placeholder="Placeholder" commandProps={{
      className: "max-w-[300px]"
    }} defaultOptions={defaultOptions} />;
  }
}`,...(P=(Z=M.parameters)==null?void 0:Z.docs)==null?void 0:P.source}}};var ee,te,ae;I.parameters={...I.parameters,docs:{...(ee=I.parameters)==null?void 0:ee.docs,source:{originalSource:`{
  render: () => {
    const [values, setValues] = useState<string[]>(["Nextjs"]);
    return <MultiSelector value={values} onChange={newValues => {
      setValues(newValues);
      action("onChange")(newValues);
    }} onSearch={async searchValue => {
      action("onSearch")(searchValue);
      return new Promise(resolve => {
        setTimeout(() => resolve(defaultOptions), 1000);
      });
    }} debounceDelay={300} className="max-w-[300px]" placeholder="Placeholder" commandProps={{
      className: "max-w-[300px]"
    }} />;
  }
}`,...(ae=(te=I.parameters)==null?void 0:te.docs)==null?void 0:ae.source}}};const He=["Default","AsyncSearch"];export{I as AsyncSearch,M as Default,He as __namedExportsOrder,Xe as default};
