import{c as me}from"./createLucideIcon-BOZfVBeY.js";import{j as t}from"./jsx-runtime-Cf8x2fCZ.js";import{g as We,e as Xe,Q as te,f as Ze,q as Je,h as oe,i as et,j as tt,k as ot,u as rt,S as nt,l as re,T as ne,B as O,m as it,n as at,o as st,p as lt,s as ct,t as dt,v as M}from"./query-builder-remote-CV1kkaXN.js";import{r as c,g as ut}from"./index-t5q4d8OJ.js";import{u as w}from"./i18n-CRCotlm3.js";import{E as mt,a as G,L as pt,b as ft,G as vt,c as yt}from"./less-than-or-equal-operator-icon-BeMEXZ7b.js";import{N as ht}from"./not-in-operator-icon-C8Fl8SMz.js";import{S as f}from"./api-CU3RBd8i.js";import{r as gt,c as xt,d as Pt}from"./capitalize-DEtw7XLf.js";import{c as h}from"./utils-CytzSlOG.js";import{C as Ct}from"./chevron-left-JBJxu620.js";import{C as jt}from"./dropdown-menu-xf-jiMEf.js";import{B as P}from"./button-DxOOzeBY.js";import{X as Dt}from"./x-Bt7o6wSZ.js";import{C as qt}from"./conditional-wrapper-BBX8pIPQ.js";import{u as bt,c as Et,b as pe,P as fe,a as b,f as Tt}from"./index-Bjkhh2p3.js";import{u as It,P as Ot,D as _t}from"./index-KhTUl610.js";import{h as wt,R as Nt,u as Ft,F as Rt}from"./Combination-CdAak5pT.js";import{c as ve,R as kt,A as ye,C as St,a as Qt}from"./index-BiFLoO8l.js";import{P as he}from"./index-V1T-MO6M.js";import{D as At,a as Bt,b as Lt,c as Vt,d as Mt,e as Gt}from"./dialog-DVZakI6I.js";import{I as Ut}from"./input-DXdBqDMR.js";import{S as $t}from"./separator-Bb2s55f8.js";import{T as zt,a as Ht,b as Yt}from"./tooltip-BvHXuUN3.js";import{a as E}from"./alert-dialog-store-CZoSfA8g.js";/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],tr=me("Copy",Kt);/**
 * @license lucide-react v0.482.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}],["path",{d:"m15 5 3 3",key:"1w25hb"}]],ge=me("PencilLine",Wt);function Xt(e){const{t:r}=w("common"),o={state:{...We(),savedFilters:[],selectedQueryIndexes:[]},onStateChange:()=>{},...e},[n]=c.useState(()=>({current:Xe(o)})),[i,a]=c.useState(()=>o.initialState||o.state);c.useEffect(()=>{var s;i&&((s=e.onStateChange)==null||s.call(e,i))},[i]),c.useEffect(()=>{const s=u=>{var d,v,y,m;if(u.queryBuilderId===e.id){if(u.eventType===oe.ADD_QUERY){const p=u.eventData;(d=e.onQueryCreate)==null||d.call(e,p),p.id===u.value.activeQueryId&&((v=e.onActiveQueryChange)==null||v.call(e,p))}else if(u.eventType===oe.UPDATE_QUERY){const p=u.eventData;(y=e.onQueryUpdate)==null||y.call(e,p),p.id===u.value.activeQueryId&&((m=e.onActiveQueryChange)==null||m.call(e,p))}a(p=>({...p,...e.state,...u.value}))}};return window.addEventListener(te,s),()=>{window.removeEventListener(te,s)}},[e.state]),e.fieldsToIgnore;const l={...i,...e.state};return n.current.setCoreProps(s=>({savedFilterDefaultTitle:r("common.savedFilter.untitledFilter"),...s,...e,state:{...l,queries:e.fieldsToIgnore&&l.queries?Ze(l.queries,e.fieldsToIgnore):l.queries},onStateChange:u=>{a(u),Je.setLocalQueryBuilderState(e.id,{value:u,skipEvent:!0})}})),n.current}const xe=c.createContext(null);function N(){const e=c.useContext(xe);if(!e)throw new Error("useQueryBuilderContext must be used within a QueryBuilderContextProvider");return e}const Zt=c.createContext(null);function j(){const e=c.useContext(Zt);if(!e)throw new Error("useQueryBuilderDictContext must be used within a QueryBuilderDictContextProvider");return e}const Pe=c.createContext(null);function D(){const e=c.useContext(Pe);if(!e)throw new Error("useQueryBarContext must be used within a QueryBarContextProvider");return e}var F="Popover",[Ce,or]=Et(F,[ve]),T=ve(),[Jt,x]=Ce(F),je=e=>{const{__scopePopover:r,children:o,open:n,defaultOpen:i,onOpenChange:a,modal:l=!1}=e,s=T(r),u=c.useRef(null),[d,v]=c.useState(!1),[y,m]=bt({prop:n,defaultProp:i??!1,onChange:a,caller:F});return t.jsx(kt,{...s,children:t.jsx(Jt,{scope:r,contentId:It(),triggerRef:u,open:y,onOpenChange:m,onOpenToggle:c.useCallback(()=>m(p=>!p),[m]),hasCustomAnchor:d,onCustomAnchorAdd:c.useCallback(()=>v(!0),[]),onCustomAnchorRemove:c.useCallback(()=>v(!1),[]),modal:l,children:o})})};je.displayName=F;var De="PopoverAnchor",eo=c.forwardRef((e,r)=>{const{__scopePopover:o,...n}=e,i=x(De,o),a=T(o),{onCustomAnchorAdd:l,onCustomAnchorRemove:s}=i;return c.useEffect(()=>(l(),()=>s()),[l,s]),t.jsx(ye,{...a,...n,ref:r})});eo.displayName=De;var qe="PopoverTrigger",be=c.forwardRef((e,r)=>{const{__scopePopover:o,...n}=e,i=x(qe,o),a=T(o),l=pe(r,i.triggerRef),s=t.jsx(fe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":_e(i.open),...n,ref:l,onClick:b(e.onClick,i.onOpenToggle)});return i.hasCustomAnchor?s:t.jsx(ye,{asChild:!0,...a,children:s})});be.displayName=qe;var U="PopoverPortal",[to,oo]=Ce(U,{forceMount:void 0}),Ee=e=>{const{__scopePopover:r,forceMount:o,children:n,container:i}=e,a=x(U,r);return t.jsx(to,{scope:r,forceMount:o,children:t.jsx(he,{present:o||a.open,children:t.jsx(Ot,{asChild:!0,container:i,children:n})})})};Ee.displayName=U;var C="PopoverContent",Te=c.forwardRef((e,r)=>{const o=oo(C,e.__scopePopover),{forceMount:n=o.forceMount,...i}=e,a=x(C,e.__scopePopover);return t.jsx(he,{present:n||a.open,children:a.modal?t.jsx(no,{...i,ref:r}):t.jsx(io,{...i,ref:r})})});Te.displayName=C;var ro=Tt("PopoverContent.RemoveScroll"),no=c.forwardRef((e,r)=>{const o=x(C,e.__scopePopover),n=c.useRef(null),i=pe(r,n),a=c.useRef(!1);return c.useEffect(()=>{const l=n.current;if(l)return wt(l)},[]),t.jsx(Nt,{as:ro,allowPinchZoom:!0,children:t.jsx(Ie,{...e,ref:i,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:b(e.onCloseAutoFocus,l=>{var s;l.preventDefault(),a.current||(s=o.triggerRef.current)==null||s.focus()}),onPointerDownOutside:b(e.onPointerDownOutside,l=>{const s=l.detail.originalEvent,u=s.button===0&&s.ctrlKey===!0,d=s.button===2||u;a.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:b(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),io=c.forwardRef((e,r)=>{const o=x(C,e.__scopePopover),n=c.useRef(!1),i=c.useRef(!1);return t.jsx(Ie,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var l,s;(l=e.onCloseAutoFocus)==null||l.call(e,a),a.defaultPrevented||(n.current||(s=o.triggerRef.current)==null||s.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{var u,d;(u=e.onInteractOutside)==null||u.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=a.target;((d=o.triggerRef.current)==null?void 0:d.contains(l))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&i.current&&a.preventDefault()}})}),Ie=c.forwardRef((e,r)=>{const{__scopePopover:o,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:l,onEscapeKeyDown:s,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:v,...y}=e,m=x(C,o),p=T(o);return Ft(),t.jsx(Rt,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:t.jsx(_t,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:v,onEscapeKeyDown:s,onPointerDownOutside:u,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:t.jsx(St,{"data-state":_e(m.open),role:"dialog",id:m.contentId,...p,...y,ref:r,style:{...y.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Oe="PopoverClose",ao=c.forwardRef((e,r)=>{const{__scopePopover:o,...n}=e,i=x(Oe,o);return t.jsx(fe.button,{type:"button",...n,ref:r,onClick:b(e.onClick,()=>i.onOpenChange(!1))})});ao.displayName=Oe;var so="PopoverArrow",lo=c.forwardRef((e,r)=>{const{__scopePopover:o,...n}=e,i=T(o);return t.jsx(Qt,{...i,...n,ref:r})});lo.displayName=so;function _e(e){return e?"open":"closed"}var co=je,uo=be,mo=Ee,we=Te;const po=co,fo=uo,$=c.forwardRef(({className:e,align:r="center",sideOffset:o=4,...n},i)=>t.jsx(mo,{children:t.jsx(we,{ref:i,align:r,sideOffset:o,className:h("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));$.displayName=we.displayName;$.__docgenInfo={description:"",methods:[],props:{align:{defaultValue:{value:'"center"',computed:!1},required:!1},sideOffset:{defaultValue:{value:"4",computed:!1},required:!1}}};function Ne({type:e,size:r,className:o}){switch(e){case f.GreaterThan:return t.jsx(yt,{size:r,className:o});case f.GreaterThanOrEqualTo:return t.jsx(vt,{size:r,className:o});case f.LessThan:return t.jsx(ft,{size:r,className:o});case f.LessThanOrEqualTo:return t.jsx(pt,{size:r,className:o});case f.Between:return t.jsx(G,{size:r,className:o});case f.NotIn:return t.jsx(ht,{size:r,className:o});default:return t.jsx(mt,{size:r,className:o})}}Ne.__docgenInfo={description:"",methods:[],displayName:"QueryPillOperator",props:{size:{required:!1,tsType:{name:"number"},description:""},type:{required:!0,tsType:{name:"union",raw:"SqonOpEnum | (string & {})",elements:[{name:"SqonOpEnum"},{name:"unknown"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};var S,ie;function vo(){if(ie)return S;ie=1;var e=/\s/;function r(o){for(var n=o.length;n--&&e.test(o.charAt(n)););return n}return S=r,S}var Q,ae;function yo(){if(ae)return Q;ae=1;var e=vo(),r=/^\s+/;function o(n){return n&&n.slice(0,e(n)+1).replace(r,"")}return Q=o,Q}var A,se;function ho(){if(se)return A;se=1;var e=yo(),r=et(),o=gt(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,s=parseInt;function u(d){if(typeof d=="number")return d;if(o(d))return n;if(r(d)){var v=typeof d.valueOf=="function"?d.valueOf():d;d=r(v)?v+"":v}if(typeof d!="string")return d===0?d:+d;d=e(d);var y=a.test(d);return y||l.test(d)?s(d.slice(2),y?2:8):i.test(d)?n:+d}return A=u,A}var B,le;function go(){if(le)return B;le=1;var e=ho(),r=1/0,o=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=e(i),i===r||i===-1/0){var a=i<0?-1:1;return a*o}return i===i?i:0}return B=n,B}var L,ce;function xo(){if(ce)return L;ce=1;var e=go();function r(o){var n=e(o),i=n%1;return n===n?i?n-i:n:0}return L=r,L}var V,de;function Po(){if(de)return V;de=1;var e=xt(),r=xo();function o(n,i,a){return n&&n.length?(i=a||i===void 0?1:r(i),e(n,0,i<0?0:i)):[]}return V=o,V}var Co=Po();const jo=ut(Co);function Fe({className:e,...r}){return t.jsx("span",{className:e,...r,children:"&"})}Fe.__docgenInfo={description:"",methods:[],displayName:"IntersectionOperator"};function Re({className:e,...r}){return t.jsx("span",{className:e,...r,children:","})}Re.__docgenInfo={description:"",methods:[],displayName:"UnionOperator"};function I({canExpand:e,className:r,classNameContent:o,children:n,clickable:i,...a}){return t.jsx("div",{className:h("bg-background rounded-sm pl-2 text-xs font-medium leading-5 relative",e?"pr-[22px]":"pr-2",r),...a,children:t.jsx("div",{className:h("flex flex-wrap items-center",i?"hover:shadow-[inset_0_-4px_0_-2.5px_black] hover:cursor-pointer":"",o),children:n})})}I.__docgenInfo={description:"",methods:[],displayName:"QueryPillValuesContainer",props:{canExpand:{required:!1,tsType:{name:"boolean"},description:""},clickable:{required:!1,tsType:{name:"boolean"},description:""},classNameContent:{required:!1,tsType:{name:"string"},description:""}}};function R({valueFilter:e,...r}){const[o,n]=c.useState(!1),{t:i}=w("common"),a=e.content.value.length>3,l=o?e.content.value:jo(e.content.value,3);return t.jsxs(I,{canExpand:a,...r,children:[e.content.overrideValuesName?t.jsx("div",{children:t.jsx("span",{children:e.content.overrideValuesName})}):l.map((s,u)=>t.jsxs("div",{children:[t.jsx("span",{children:i(`common.filters.labels.${e.content.field}_value.${s}`,{defaultValue:String(s)})}),l.length-1>u&&(e.op===f.All?t.jsx(Fe,{className:"px-1"}):t.jsx(Re,{className:"px-1"}))]},`${s}-${u}`)),a&&t.jsx("div",{className:"absolute right-1 hover:cursor-pointer",children:o?t.jsx(Ct,{size:16,onClick:s=>{s.preventDefault(),n(!1)}}):t.jsx(jt,{size:16,onClick:s=>{s.preventDefault(),n(!0)}})})]})}R.__docgenInfo={description:"",methods:[],displayName:"QueryPillValues",props:{valueFilter:{required:!0,tsType:{name:"IValueFilter"},description:""}}};function q({children:e,className:r,onRemovePill:o,...n}){return t.jsxs("div",{className:h("flex items-center rounded-sm p-[2px] bg-muted group-data-[query-active=true]/query:bg-primary/25",r),...n,children:[e,t.jsx(P,{iconOnly:!0,variant:"ghost",size:"sm",className:"mr-[2px] ml-[4px] py-[2px] enabled:hover:bg-transparent size-4",onClick:i=>{i.stopPropagation(),o()},children:t.jsx(Dt,{})})]})}q.__docgenInfo={description:"",methods:[],displayName:"QueryPillContainer",props:{onRemovePill:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};function z({valueFilter:e,operator:r,className:o,...n}){const i=j(),{showLabels:a}=N();return t.jsx("div",{className:h("flex items-center",o),...n,children:(a||tt(e)||ot(e))&&t.jsxs(t.Fragment,{children:[t.jsx(Y,{children:i.queryPill.facet(e.content.field)}),t.jsx(H,{children:r})]})})}const H=({className:e,children:r,...o})=>t.jsx("span",{className:h("ml-[2px] mr-[4px]",e),...o,children:r});function Y({className:e,children:r,...o}){return t.jsx("span",{className:h("ml-[4px] mr-[2px] text-xs font-medium",e),...o,children:r})}H.__docgenInfo={description:"",methods:[],displayName:"QueryPillOperatorContainer"};Y.__docgenInfo={description:"",methods:[],displayName:"QueryPillLabelContainer"};z.__docgenInfo={description:"",methods:[],displayName:"QueryPillLabelOperator",props:{valueFilter:{required:!0,tsType:{name:"IValueFilter"},description:""},operator:{required:!0,tsType:{name:"ReactNode"},description:""}}};function K({valueFilter:e,customPillEditEnabled:r}){var u;const{query:o}=D(),{queryPillFacetFilterConfig:n}=N(),[i,a]=c.useState(),l=!!(!r&&(n!=null&&n.enable)&&!((u=n==null?void 0:n.blacklistedFacets)!=null&&u.includes(e.content.field))),s=c.useCallback(()=>{n!=null&&n.onFacetClick&&!i&&a(n.onFacetClick(e))},[i,n==null?void 0:n.onFacetClick]);return t.jsxs(q,{onRemovePill:()=>o.removePillByFieldOrIndex(e.content.field),children:[t.jsx(z,{valueFilter:e,operator:t.jsx(Ne,{size:14,type:e.op})}),t.jsx(qt,{condition:l,wrapper:d=>t.jsxs(po,{children:[t.jsx(fo,{onClick:s,children:d}),t.jsx($,{align:"start",className:"p-2.5",children:i})]}),children:t.jsx(R,{valueFilter:e,clickable:l})})]})}K.__docgenInfo={description:"",methods:[],displayName:"QueryPillField",props:{valueFilter:{required:!0,tsType:{name:"IValueFilter"},description:""},customPillEditEnabled:{required:!1,tsType:{name:"boolean"},description:""}}};function ke(){const{t:e}=w();return t.jsx("div",{children:e("common.components.queryPillRemote")})}ke.__docgenInfo={description:"",methods:[],displayName:"QueryPillRemoteComponent"};function Se({valueFilter:e}){const{query:r}=D();return t.jsxs(q,{onRemovePill:()=>r.removePillByFieldOrIndex(e.content.field),children:[t.jsx(z,{valueFilter:e,operator:t.jsx(G,{size:14,type:e.op})}),t.jsx(R,{valueFilter:e})]})}Se.__docgenInfo={description:"",methods:[],displayName:"QueryPillUploadList",props:{valueFilter:{required:!0,tsType:{name:"IValueFilter"},description:""}}};function Qe({valueFilter:e}){const{query:r}=D(),o=j();return t.jsxs(q,{onRemovePill:()=>r.removePillByFieldOrIndex(e.content.field),children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Y,{children:e.content.index?Pt(e.content.index):o.queryPill.facet(e.content.field)}),t.jsx(H,{children:t.jsx(G,{size:14})})]}),t.jsx(I,{children:t.jsx(R,{valueFilter:e})})]})}Qe.__docgenInfo={description:"",methods:[],displayName:"QueryPillSet",props:{valueFilter:{required:!0,tsType:{name:"IValueFilter"},description:""}}};function Ae({refIndex:e}){const{query:r}=D(),{getQueryReferenceColor:o}=N(),n=o(e);return t.jsx(q,{onRemovePill:()=>r.removePillByFieldOrIndex(e),children:t.jsx(I,{children:t.jsx("span",{style:{color:n},children:`Q${e+1}`})})})}Ae.__docgenInfo={description:"",methods:[],displayName:"QueryPillReference",props:{refIndex:{required:!0,tsType:{name:"number"},description:""}}};const Be=({children:e,icon:r=ge,onChangeText:o,...n})=>{const[i,a]=c.useState(!1),l=r;return t.jsx("div",{...n,children:i?t.jsx(Ut,{defaultValue:e,autoFocus:!0,onBlur:s=>{a(!1),o==null||o(s.currentTarget.value)},className:"max-w-96 w-full",onKeyUp:s=>{s.key==="Enter"&&(a(!1),o==null||o(s.currentTarget.value))}}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:e}),t.jsx(P,{iconOnly:!0,variant:"ghost",onClick:()=>a(!0),children:t.jsx(l,{})})]})})};Be.__docgenInfo={description:"",methods:[],displayName:"EditableText",props:{icon:{required:!1,tsType:{name:"ReactForwardRefExoticComponent",raw:"React.ForwardRefExoticComponent<Omit<LucideProps, 'ref'> & React.RefAttributes<SVGSVGElement>>",elements:[{name:"intersection",raw:"Omit<LucideProps, 'ref'> & React.RefAttributes<SVGSVGElement>",elements:[{name:"Omit",elements:[{name:"LucideProps"},{name:"literal",value:"'ref'"}],raw:"Omit<LucideProps, 'ref'>"},{name:"ReactRefAttributes",raw:"React.RefAttributes<SVGSVGElement>",elements:[{name:"SVGSVGElement"}]}]}]},description:"",defaultValue:{value:"PencilLineIcon",computed:!0}},children:{required:!0,tsType:{name:"string"},description:""},onChangeText:{required:!1,tsType:{name:"signature",type:"function",raw:"(text: string) => void",signature:{arguments:[{type:{name:"string"},name:"text"}],return:{name:"void"}}},description:""}}};function rr(e,r){E.open({type:"warning",title:r.savedFilter.deleteDialog.title,description:r.savedFilter.deleteDialog.description,cancelProps:{children:r.savedFilter.deleteDialog.cancel},actionProps:{color:"destructive",onClick:()=>e.delete(),children:r.savedFilter.deleteDialog.ok}})}function nr(e,r){E.open({type:"warning",title:r.savedFilter.overwriteDialog.title,description:r.savedFilter.overwriteDialog.description,cancelProps:{children:r.savedFilter.overwriteDialog.cancel},actionProps:{onClick:()=>e.createSavedFilter(),children:r.savedFilter.overwriteDialog.ok}})}function Do(e){E.open({type:"error",title:e.queryPill.customPill.cantBeEmptyDialog.title,description:e.queryPill.customPill.cantBeEmptyDialog.description,hideCancel:!0,actionProps:{children:e.queryPill.customPill.cantBeEmptyDialog.ok}})}function qo(e){E.open({type:"error",title:e.queryPill.customPill.titleExistsDialog.title,description:e.queryPill.customPill.titleExistsDialog.description,hideCancel:!0,actionProps:{children:e.queryPill.customPill.titleExistsDialog.ok}})}function bo(e,r,o,n){E.open({type:"warning",title:e.queryPill.customPill.saveDialog.title,description:t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{children:e.queryPill.customPill.saveDialog.confirmationMessage.replace("{title}",r)}),!!(o!=null&&o.length)&&t.jsxs("div",{className:"border rounded p-4 space-y-2",children:[t.jsx("div",{className:"font-medium text-foreground",children:e.queryPill.customPill.saveDialog.affectedFilters}),t.jsx("ul",{className:"list-disc list-inside",children:o.map(i=>t.jsx("li",{className:"list-item",children:i.title}))})]})]}),cancelProps:{children:e.queryPill.customPill.saveDialog.cancel},actionProps:{children:e.queryPill.customPill.saveDialog.ok,onClick:async i=>(i.preventDefault(),n())}})}function Le({open:e,onOpenChange:r,queryPill:o}){const n=j(),{queryBuilder:i,customPillConfig:a}=N(),l=Xt({id:a==null?void 0:a.queryBuilderEditId,initialState:{activeQueryId:o.queries[0].id,queries:o.queries,savedFilters:[o],selectedQueryIndexes:[]},onCustomPillUpdate:async g=>{var Z,J;return await Promise.resolve((J=(Z=i.coreProps).onCustomPillUpdate)==null?void 0:J.call(Z,g)).then(Ke=>(i.setState(ee=>({...ee,queries:rt(ee.queries,g)})),r(!1),Ke))}}),[s,u]=c.useState(o.title),[d,v]=c.useState(!1),y=l.getQueries()[0],m=l.getSelectedSavedFilter(),p=s!==o.title,X=p||(m==null?void 0:m.isDirty()),He=c.useCallback(g=>{g?r(!0):(l.reset(),r(!1))},[r,l]),Ye=c.useCallback(async()=>{if(y.isEmpty()){Do(n);return}if(v(!0),p){const k=await(a==null?void 0:a.validateCustomPillTitle(s));if(k!==void 0&&k===!1){v(!1),qo(n);return}}const g=await(a==null?void 0:a.fetchSavedFiltersByCustomPillId(o.id).finally(()=>v(!1)));bo(n,s,g,async()=>m==null?void 0:m.save(nt.Query,{title:s}))},[y,m,n,s,o.id,a]);return t.jsx(At,{open:e,onOpenChange:He,children:t.jsx(xe.Provider,{value:{queryBuilder:l,fetchQueryCount:async()=>0,getQueryReferenceColor:()=>"",showLabels:!0,resolveSyntheticSqon:g=>g},children:t.jsxs(Bt,{className:"flex flex-row gap-0 h-screen w-screen max-w-screen rounded-none border-none sm:rounded-none p-0",children:[t.jsx("aside",{className:"flex flex-col min-w-48 bg-primary",children:t.jsx("span",{className:"italic",children:"TODO Insert filters"})}),t.jsx("div",{className:"w-full",children:t.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[t.jsx(Lt,{children:t.jsx(Vt,{children:n.queryPill.customPill.editDialog.title})}),t.jsx($t,{}),t.jsx("div",{children:t.jsx(Be,{onChangeText:u,children:s})}),t.jsx("div",{"data-query-active":!0,className:"flex flex-wrap group/query",children:t.jsx(Pe.Provider,{value:{query:y},children:t.jsx(W,{sqon:y.raw(),customPillEditEnabled:!0})})}),t.jsxs(Mt,{className:"mt-5",children:[t.jsx(Gt,{asChild:!0,children:t.jsx(P,{variant:"outline",children:n.queryPill.customPill.editDialog.cancel})}),t.jsx(P,{type:"submit",loading:d,disabled:!X,onClick:Ye,children:n.queryPill.customPill.editDialog.ok})]})]})})]})})})}Le.__docgenInfo={description:"",methods:[],displayName:"QueryPillCustomEditDialog",props:{open:{required:!0,tsType:{name:"boolean"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(open: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"open"}],return:{name:"void"}}},description:""},queryPill:{required:!0,tsType:{name:"ISavedFilter"},description:""}}};function Ve({valueQuery:e}){const{query:r}=D(),[o,n]=c.useState(!1),{title:i,...a}=e,l={id:e.id,title:e.title,queries:[a],favorite:!1};return t.jsxs(t.Fragment,{children:[t.jsx(q,{onRemovePill:()=>r.removePillById(e.id),children:t.jsxs(I,{className:"pr-1",classNameContent:"space-x-1",children:[t.jsx("span",{children:e.title}),t.jsx(P,{iconOnly:!0,size:"xs",variant:"ghost",className:"size-auto p-[2px]",onClick:()=>n(!0),children:t.jsx(ge,{})})]})}),o&&t.jsx(Le,{open:o,onOpenChange:n,queryPill:l})]})}Ve.__docgenInfo={description:"",methods:[],displayName:"QueryPillCustom",props:{valueQuery:{required:!0,tsType:{name:"IValueQuery"},description:""}}};function Me({groupFilter:e}){const r={},o=c.useMemo(()=>(e.content.forEach(n=>{r.hasOwnProperty(n.content.field)?(r[n.content.field]=re(r[n.content.field]),r[n.content.field].content.value=r[n.content.field].content.value.concat(n.content.value),n.op===ne.In&&e.op===O.And&&e.skipBooleanOperatorCheck&&(r[n.content.field].op=ne.All)):r[n.content.field]=re(n)}),{...e,content:Object.entries(r).map(n=>n[1])}),[e]);return t.jsx(K,{valueFilter:o.content[0]})}Me.__docgenInfo={description:"",methods:[],displayName:"QueryPillIsolatedBoolean",props:{groupFilter:{required:!0,tsType:{name:"ISqonGroupFilter"},description:""}}};function Ge({className:e,...r}){const o=j();return t.jsx("span",{className:h("",e),...r,children:o.queryPill.operator.and})}Ge.__docgenInfo={description:"",methods:[],displayName:"AndOperator"};function Ue({className:e,...r}){const o=j();return t.jsx("span",{className:h("",e),...r,children:o.queryPill.operator.or})}Ue.__docgenInfo={description:"",methods:[],displayName:"OrOperator"};function $e(){const{query:e}=D(),r=j(),o=e.raw().op===O.And;return t.jsx("div",{className:"px-2",onClick:n=>n.stopPropagation(),children:t.jsxs(zt,{children:[t.jsx(Ht,{asChild:!0,children:t.jsx(P,{variant:"link",className:"text-current text-sm p-0 h-auto font-normal",onClick:()=>e.changeCombineOperator(o?O.Or:O.And),children:o?t.jsx(Ge,{}):t.jsx(Ue,{})})}),t.jsxs(Yt,{children:[r.queryPill.operator.changeOperatorTo,' "',o?r.queryPill.operator.or:r.queryPill.operator.and,'"']})]})})}$e.__docgenInfo={description:"",methods:[],displayName:"QueryCombiner"};function W({sqon:e,customPillEditEnabled:r}){return t.jsx(t.Fragment,{children:e.content.map((o,n)=>t.jsxs("div",{className:"flex items-center py-[2px]",children:[o.skipBooleanOperatorCheck?t.jsx(Me,{groupFilter:o}):it(o)?t.jsx(Ve,{valueQuery:o}):at(o)?t.jsx(W,{sqon:o}):st(o)?t.jsx(Ae,{refIndex:o}):lt(o)?t.jsx(Qe,{valueFilter:o}):ct(o)?t.jsx(Se,{valueFilter:o}):dt(o)?t.jsx(ke,{}):t.jsx(K,{valueFilter:o,customPillEditEnabled:r}),Eo(e.content,n)&&t.jsx($e,{})]},n))})}const Eo=(e,r)=>e.length-1>r;W.__docgenInfo={description:"",methods:[],displayName:"QueryPillBoolean",props:{sqon:{required:!0,tsType:{name:"ISyntheticSqon"},description:""},customPillEditEnabled:{required:!1,tsType:{name:"boolean"},description:""}}};const ir=()=>{const{t:e}=w("common");return{queryBar:{empty:e("common.queryBar.empty"),deletePopover:{title:e("common.queryBar.deletePopover.title"),cancel:e("common.queryBar.deletePopover.cancel"),ok:e("common.queryBar.deletePopover.ok")},customPill:{createTooltip:e("common.queryBar.customPill.createTooltip"),cannotSaveAsCustomPill:e("common.queryBar.customPill.cannotSaveAsCustomPill")},saveDialog:{title:e("common.queryBar.saveDialog.title"),fields:{title:{label:e("common.queryBar.saveDialog.fields.title.label"),placeholder:e("common.queryBar.saveDialog.fields.title.placeholder")}},notice:e("common.queryBar.saveDialog.notice"),cancel:e("common.queryBar.saveDialog.cancel"),ok:e("common.queryBar.saveDialog.ok")}},queryPill:{operator:{changeOperatorTo:e("common.queryPill.operator.changeOperatorTo"),and:e("common.queryPill.operator.and"),or:e("common.queryPill.operator.or")},facet:r=>e(`common.filters.labels.${r}`,{defaultValue:r}),customPill:{editDialog:{title:e("common.queryPill.customPill.editDialog.title"),cancel:e("common.queryPill.customPill.editDialog.cancel"),ok:e("common.queryPill.customPill.editDialog.ok")},cantBeEmptyDialog:{title:e("common.queryPill.customPill.cantBeEmptyDialog.title"),description:e("common.queryPill.customPill.cantBeEmptyDialog.description"),ok:e("common.queryPill.customPill.cantBeEmptyDialog.ok")},titleExistsDialog:{title:e("common.queryPill.customPill.titleExistsDialog.title"),description:e("common.queryPill.customPill.titleExistsDialog.description"),ok:e("common.queryPill.customPill.titleExistsDialog.ok")},saveDialog:{title:e("common.queryPill.customPill.saveDialog.title"),confirmationMessage:e("common.queryPill.customPill.saveDialog.confirmationMessage"),affectedFilters:e("common.queryPill.customPill.saveDialog.affectedFilters"),cancel:e("common.queryPill.customPill.saveDialog.cancel"),ok:e("common.queryPill.customPill.saveDialog.ok")}}},toolbar:{combine:e("common.toolbar.combine"),newQuery:e("common.toolbar.newQuery"),clearAll:e("common.toolbar.clearAll"),clearAllDialog:{title:e("common.toolbar.clearAllDialog.title"),description:e("common.toolbar.clearAllDialog.description"),cancel:e("common.toolbar.clearAllDialog.cancel"),ok:e("common.toolbar.clearAllDialog.ok")},labels:e("common.toolbar.labels")},savedFilter:{deleteTooltip:e("common.savedFilter.deleteTooltip"),deleteDialog:{title:e("common.savedFilter.deleteDialog.title"),description:e("common.savedFilter.deleteDialog.description"),cancel:e("common.savedFilter.deleteDialog.cancel"),ok:e("common.savedFilter.deleteDialog.ok")},duplicateTooltip:e("common.savedFilter.duplicateTooltip"),overwriteDialog:{title:e("common.savedFilter.overwriteDialog.title"),description:e("common.savedFilter.overwriteDialog.description"),cancel:e("common.savedFilter.overwriteDialog.cancel"),ok:e("common.savedFilter.overwriteDialog.ok")},editDialog:{title:e("common.savedFilter.editDialog.title"),cancel:e("common.savedFilter.editDialog.cancel"),ok:e("common.savedFilter.editDialog.ok"),fields:{title:{label:e("common.savedFilter.editDialog.fields.title.label"),placeholder:e("common.savedFilter.editDialog.fields.title.placeholder")}}},myFilters:e("common.savedFilter.myFilters"),manageFilters:e("common.savedFilter.manageFilters"),manageDialog:{title:e("common.savedFilter.manageDialog.title"),close:e("common.savedFilter.manageDialog.close"),lastSaveAt:e("common.savedFilter.manageDialog.lastSaveAt")},newFilter:e("common.savedFilter.newFilter"),saveTooltip:{whenEmpty:e("common.savedFilter.saveTooltip.whenEmpty"),whenDirty:e("common.savedFilter.saveTooltip.whenDirty"),default:e("common.savedFilter.saveTooltip.default")},shareTooltip:{whenNotSaved:e("common.savedFilter.shareTooltip.whenNotSaved"),default:e("common.savedFilter.shareTooltip.default")},favoriteTooltip:{set:e("common.savedFilter.favoriteTooltip.set"),unset:e("common.savedFilter.favoriteTooltip.unset")},discardTooltip:e("common.savedFilter.discardTooltip"),noSavedFilters:e("common.savedFilter.noSavedFilters")}}},ar=["#C31D7E","#328536","#AA00FF","#C2410C","#047ABE","#E5231F","#007D85","#C51162","#7B5A90","#B85C00","#722ED1","#4D7C0F","#9F1239","#2D7D9A","#847545"];function ue(e){return e[Math.floor(Math.random()*e.length)]}function _(e=1,r=100){return Math.floor(Math.random()*(r-e+1))+e}function ze(){return Math.random().toString(36).substring(7)}const To=[f.GreaterThan,f.LessThan,f.Between,f.GreaterThanOrEqualTo,f.LessThanOrEqualTo];function sr(e){return{id:M(),title:(e==null?void 0:e.title)||`Custom Pill ${_(1,50)}`,queries:[Oo()],keycloak_id:M(),creation_date:new Date().toISOString(),updated_date:new Date().toISOString(),tag:"tag",favorite:!1}}function Io(e){return To.includes(e)?Array.from({length:2},()=>_()):Array.from({length:_(2,5)},()=>ze())}function Oo(e=M()){const r=_(1,3),o=Array.from({length:r},()=>{const n=Object.values(f).filter(a=>a!==f.And&&a!==f.Or&&a!==f.Not),i=ue(n);return{op:i,content:{field:`field_${ze()}`,value:Io(i)}}});return{id:e,op:ue(["and","or"]),content:o}}export{tr as C,ge as P,Zt as Q,Xt as a,xe as b,Le as c,D as d,N as e,j as f,sr as g,po as h,fo as i,$ as j,ao as k,Pe as l,W as m,rr as n,nr as o,ar as p,Oo as q,ir as u};
