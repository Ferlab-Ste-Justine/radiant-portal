import{j as N}from"./jsx-runtime-Cf8x2fCZ.js";import{r as l}from"./index-tvICUrOf.js";import{R as je,P as _e,O as $e,a as De}from"./index-BNc2EN3H.js";import{P as M,h as T}from"./index-Csi1vtvD.js";import{u as F}from"./Combination-CmKP2mMJ.js";import{c as A}from"./utils-CytzSlOG.js";import"./dialog-CsMtKPah.js";var fe=1,Pe=.9,qe=.8,Fe=.17,ee=.1,te=.999,Ke=.9999,Le=.99,Te=/[\\\/_+.#"@\[\(\{&]/,Ve=/[\\\/_+.#"@\[\(\{&]/g,Oe=/[\s-]/,he=/[\s-]/g;function ne(e,n,t,c,a,u,s){if(u===n.length)return a===e.length?fe:Le;var f=`${a},${u}`;if(s[f]!==void 0)return s[f];for(var b=c.charAt(u),i=t.indexOf(b,a),v=0,h,R,x,S;i>=0;)h=ne(e,n,t,c,i+1,u+1,s),h>v&&(i===a?h*=fe:Te.test(e.charAt(i-1))?(h*=qe,x=e.slice(a,i-1).match(Ve),x&&a>0&&(h*=Math.pow(te,x.length))):Oe.test(e.charAt(i-1))?(h*=Pe,S=e.slice(a,i-1).match(he),S&&a>0&&(h*=Math.pow(te,S.length))):(h*=Fe,a>0&&(h*=Math.pow(te,i-a))),e.charAt(i)!==n.charAt(u)&&(h*=Ke)),(h<ee&&t.charAt(i-1)===c.charAt(u+1)||c.charAt(u+1)===c.charAt(u)&&t.charAt(i-1)!==c.charAt(u))&&(R=ne(e,n,t,c,i+1,u+2,s),R*ee>h&&(h=R*ee)),h>v&&(v=h),i=t.indexOf(b,i+1);return s[f]=v,v}function pe(e){return e.toLowerCase().replace(he," ")}function ze(e,n,t){return e=t&&t.length>0?`${e+" "+t.join(" ")}`:e,ne(e,n,pe(e),pe(n),0,0,{})}var L='[cmdk-group=""]',re='[cmdk-group-items=""]',Be='[cmdk-group-heading=""]',ge='[cmdk-item=""]',ve=`${ge}:not([aria-disabled="true"])`,le="cmdk-item-select",P="data-value",Ge=(e,n,t)=>ze(e,n,t),be=l.createContext(void 0),V=()=>l.useContext(be),ye=l.createContext(void 0),ae=()=>l.useContext(ye),we=l.createContext(void 0),xe=l.forwardRef((e,n)=>{let t=q(()=>{var r,d;return{search:"",value:(d=(r=e.value)!=null?r:e.defaultValue)!=null?d:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),c=q(()=>new Set),a=q(()=>new Map),u=q(()=>new Map),s=q(()=>new Set),f=ke(e),{label:b,children:i,value:v,onValueChange:h,filter:R,shouldFilter:x,loop:S,disablePointerSelection:G=!1,vimBindings:j=!0,...O}=e,U=F(),oe=F(),H=F(),_=l.useRef(null),y=rt();$(()=>{if(v!==void 0){let r=v.trim();t.current.value=r,k.emit()}},[v]),$(()=>{y(6,ue)},[]);let k=l.useMemo(()=>({subscribe:r=>(s.current.add(r),()=>s.current.delete(r)),snapshot:()=>t.current,setState:(r,d,m)=>{var o,p,g,E;if(!Object.is(t.current[r],d)){if(t.current[r]=d,r==="search")Y(),J(),y(1,X);else if(r==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let w=document.getElementById(H);w?w.focus():(o=document.getElementById(U))==null||o.focus()}if(y(7,()=>{var w;t.current.selectedItemId=(w=D())==null?void 0:w.id,k.emit()}),m||y(5,ue),((p=f.current)==null?void 0:p.value)!==void 0){let w=d??"";(E=(g=f.current).onValueChange)==null||E.call(g,w);return}}k.emit()}},emit:()=>{s.current.forEach(r=>r())}}),[]),W=l.useMemo(()=>({value:(r,d,m)=>{var o;d!==((o=u.current.get(r))==null?void 0:o.value)&&(u.current.set(r,{value:d,keywords:m}),t.current.filtered.items.set(r,ie(d,m)),y(2,()=>{J(),k.emit()}))},item:(r,d)=>(c.current.add(r),d&&(a.current.has(d)?a.current.get(d).add(r):a.current.set(d,new Set([r]))),y(3,()=>{Y(),J(),t.current.value||X(),k.emit()}),()=>{u.current.delete(r),c.current.delete(r),t.current.filtered.items.delete(r);let m=D();y(4,()=>{Y(),(m==null?void 0:m.getAttribute("id"))===r&&X(),k.emit()})}),group:r=>(a.current.has(r)||a.current.set(r,new Set),()=>{u.current.delete(r),a.current.delete(r)}),filter:()=>f.current.shouldFilter,label:b||e["aria-label"],getDisablePointerSelection:()=>f.current.disablePointerSelection,listId:U,inputId:H,labelId:oe,listInnerRef:_}),[]);function ie(r,d){var m,o;let p=(o=(m=f.current)==null?void 0:m.filter)!=null?o:Ge;return r?p(r,t.current.search,d):0}function J(){if(!t.current.search||f.current.shouldFilter===!1)return;let r=t.current.filtered.items,d=[];t.current.filtered.groups.forEach(o=>{let p=a.current.get(o),g=0;p.forEach(E=>{let w=r.get(E);g=Math.max(w,g)}),d.push([o,g])});let m=_.current;K().sort((o,p)=>{var g,E;let w=o.getAttribute("id"),z=p.getAttribute("id");return((g=r.get(z))!=null?g:0)-((E=r.get(w))!=null?E:0)}).forEach(o=>{let p=o.closest(re);p?p.appendChild(o.parentElement===p?o:o.closest(`${re} > *`)):m.appendChild(o.parentElement===m?o:o.closest(`${re} > *`))}),d.sort((o,p)=>p[1]-o[1]).forEach(o=>{var p;let g=(p=_.current)==null?void 0:p.querySelector(`${L}[${P}="${encodeURIComponent(o[0])}"]`);g==null||g.parentElement.appendChild(g)})}function X(){let r=K().find(m=>m.getAttribute("aria-disabled")!=="true"),d=r==null?void 0:r.getAttribute(P);k.setState("value",d||void 0)}function Y(){var r,d,m,o;if(!t.current.search||f.current.shouldFilter===!1){t.current.filtered.count=c.current.size;return}t.current.filtered.groups=new Set;let p=0;for(let g of c.current){let E=(d=(r=u.current.get(g))==null?void 0:r.value)!=null?d:"",w=(o=(m=u.current.get(g))==null?void 0:m.keywords)!=null?o:[],z=ie(E,w);t.current.filtered.items.set(g,z),z>0&&p++}for(let[g,E]of a.current)for(let w of E)if(t.current.filtered.items.get(w)>0){t.current.filtered.groups.add(g);break}t.current.filtered.count=p}function ue(){var r,d,m;let o=D();o&&(((r=o.parentElement)==null?void 0:r.firstChild)===o&&((m=(d=o.closest(L))==null?void 0:d.querySelector(Be))==null||m.scrollIntoView({block:"nearest"})),o.scrollIntoView({block:"nearest"}))}function D(){var r;return(r=_.current)==null?void 0:r.querySelector(`${ge}[aria-selected="true"]`)}function K(){var r;return Array.from(((r=_.current)==null?void 0:r.querySelectorAll(ve))||[])}function Q(r){let d=K()[r];d&&k.setState("value",d.getAttribute(P))}function Z(r){var d;let m=D(),o=K(),p=o.findIndex(E=>E===m),g=o[p+r];(d=f.current)!=null&&d.loop&&(g=p+r<0?o[o.length-1]:p+r===o.length?o[0]:o[p+r]),g&&k.setState("value",g.getAttribute(P))}function de(r){let d=D(),m=d==null?void 0:d.closest(L),o;for(;m&&!o;)m=r>0?et(m,L):tt(m,L),o=m==null?void 0:m.querySelector(ve);o?k.setState("value",o.getAttribute(P)):Z(r)}let ce=()=>Q(K().length-1),se=r=>{r.preventDefault(),r.metaKey?ce():r.altKey?de(1):Z(1)},me=r=>{r.preventDefault(),r.metaKey?Q(0):r.altKey?de(-1):Z(-1)};return l.createElement(M.div,{ref:n,tabIndex:-1,...O,"cmdk-root":"",onKeyDown:r=>{var d;(d=O.onKeyDown)==null||d.call(O,r);let m=r.nativeEvent.isComposing||r.keyCode===229;if(!(r.defaultPrevented||m))switch(r.key){case"n":case"j":{j&&r.ctrlKey&&se(r);break}case"ArrowDown":{se(r);break}case"p":case"k":{j&&r.ctrlKey&&me(r);break}case"ArrowUp":{me(r);break}case"Home":{r.preventDefault(),Q(0);break}case"End":{r.preventDefault(),ce();break}case"Enter":{r.preventDefault();let o=D();if(o){let p=new Event(le);o.dispatchEvent(p)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:W.inputId,id:W.labelId,style:lt},b),B(e,r=>l.createElement(ye.Provider,{value:k},l.createElement(be.Provider,{value:W},r))))}),Ue=l.forwardRef((e,n)=>{var t,c;let a=F(),u=l.useRef(null),s=l.useContext(we),f=V(),b=ke(e),i=(c=(t=b.current)==null?void 0:t.forceMount)!=null?c:s==null?void 0:s.forceMount;$(()=>{if(!i)return f.item(a,s==null?void 0:s.id)},[i]);let v=Ee(a,u,[e.value,e.children,u],e.keywords),h=ae(),R=C(y=>y.value&&y.value===v.current),x=C(y=>i||f.filter()===!1?!0:y.search?y.filtered.items.get(a)>0:!0);l.useEffect(()=>{let y=u.current;if(!(!y||e.disabled))return y.addEventListener(le,S),()=>y.removeEventListener(le,S)},[x,e.onSelect,e.disabled]);function S(){var y,k;G(),(k=(y=b.current).onSelect)==null||k.call(y,v.current)}function G(){h.setState("value",v.current,!0)}if(!x)return null;let{disabled:j,value:O,onSelect:U,forceMount:oe,keywords:H,..._}=e;return l.createElement(M.div,{ref:T(u,n),..._,id:a,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!R,"data-disabled":!!j,"data-selected":!!R,onPointerMove:j||f.getDisablePointerSelection()?void 0:G,onClick:j?void 0:S},e.children)}),He=l.forwardRef((e,n)=>{let{heading:t,children:c,forceMount:a,...u}=e,s=F(),f=l.useRef(null),b=l.useRef(null),i=F(),v=V(),h=C(x=>a||v.filter()===!1?!0:x.search?x.filtered.groups.has(s):!0);$(()=>v.group(s),[]),Ee(s,f,[e.value,e.heading,b]);let R=l.useMemo(()=>({id:s,forceMount:a}),[a]);return l.createElement(M.div,{ref:T(f,n),...u,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},t&&l.createElement("div",{ref:b,"cmdk-group-heading":"","aria-hidden":!0,id:i},t),B(e,x=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?i:void 0},l.createElement(we.Provider,{value:R},x))))}),We=l.forwardRef((e,n)=>{let{alwaysRender:t,...c}=e,a=l.useRef(null),u=C(s=>!s.search);return!t&&!u?null:l.createElement(M.div,{ref:T(a,n),...c,"cmdk-separator":"",role:"separator"})}),Je=l.forwardRef((e,n)=>{let{onValueChange:t,...c}=e,a=e.value!=null,u=ae(),s=C(i=>i.search),f=C(i=>i.selectedItemId),b=V();return l.useEffect(()=>{e.value!=null&&u.setState("search",e.value)},[e.value]),l.createElement(M.input,{ref:n,...c,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":b.listId,"aria-labelledby":b.labelId,"aria-activedescendant":f,id:b.inputId,type:"text",value:a?e.value:s,onChange:i=>{a||u.setState("search",i.target.value),t==null||t(i.target.value)}})}),Xe=l.forwardRef((e,n)=>{let{children:t,label:c="Suggestions",...a}=e,u=l.useRef(null),s=l.useRef(null),f=C(i=>i.selectedItemId),b=V();return l.useEffect(()=>{if(s.current&&u.current){let i=s.current,v=u.current,h,R=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let x=i.offsetHeight;v.style.setProperty("--cmdk-list-height",x.toFixed(1)+"px")})});return R.observe(i),()=>{cancelAnimationFrame(h),R.unobserve(i)}}},[]),l.createElement(M.div,{ref:T(u,n),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":f,"aria-label":c,id:b.listId},B(e,i=>l.createElement("div",{ref:T(s,b.listInnerRef),"cmdk-list-sizer":""},i)))}),Ye=l.forwardRef((e,n)=>{let{open:t,onOpenChange:c,overlayClassName:a,contentClassName:u,container:s,...f}=e;return l.createElement(je,{open:t,onOpenChange:c},l.createElement(_e,{container:s},l.createElement($e,{"cmdk-overlay":"",className:a}),l.createElement(De,{"aria-label":e.label,"cmdk-dialog":"",className:u},l.createElement(xe,{ref:n,...f}))))}),Qe=l.forwardRef((e,n)=>C(t=>t.filtered.count===0)?l.createElement(M.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),Ze=l.forwardRef((e,n)=>{let{progress:t,children:c,label:a="Loading...",...u}=e;return l.createElement(M.div,{ref:n,...u,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},B(e,s=>l.createElement("div",{"aria-hidden":!0},s)))}),I=Object.assign(xe,{List:Xe,Item:Ue,Input:Je,Group:He,Separator:We,Dialog:Ye,Empty:Qe,Loading:Ze});function et(e,n){let t=e.nextElementSibling;for(;t;){if(t.matches(n))return t;t=t.nextElementSibling}}function tt(e,n){let t=e.previousElementSibling;for(;t;){if(t.matches(n))return t;t=t.previousElementSibling}}function ke(e){let n=l.useRef(e);return $(()=>{n.current=e}),n}var $=typeof window>"u"?l.useEffect:l.useLayoutEffect;function q(e){let n=l.useRef();return n.current===void 0&&(n.current=e()),n}function C(e){let n=ae(),t=()=>e(n.snapshot());return l.useSyncExternalStore(n.subscribe,t,t)}function Ee(e,n,t,c=[]){let a=l.useRef(),u=V();return $(()=>{var s;let f=(()=>{var i;for(let v of t){if(typeof v=="string")return v.trim();if(typeof v=="object"&&"current"in v)return v.current?(i=v.current.textContent)==null?void 0:i.trim():a.current}})(),b=c.map(i=>i.trim());u.value(e,f,b),(s=n.current)==null||s.setAttribute(P,f),a.current=f}),a}var rt=()=>{let[e,n]=l.useState(),t=q(()=>new Map);return $(()=>{t.current.forEach(c=>c()),t.current=new Map},[e]),(c,a)=>{t.current.set(c,a),n({})}};function nt(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function B({asChild:e,children:n},t){return e&&l.isValidElement(n)?l.cloneElement(nt(n),{ref:n.ref},t(n.props.children)):t(n)}var lt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Ie=l.forwardRef(({className:e,...n},t)=>N.jsx(I,{ref:t,className:A("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...n}));Ie.displayName=I.displayName;const Re=l.forwardRef(({className:e,wrapperClassName:n,rightAddon:t,disabled:c,...a},u)=>N.jsxs("div",{className:A("flex h-9 items-center px-3 bg-background rounded-md border border-input enabled:focus-within:ring-1 enabled:focus-within:ring-ring",n,{"cursor-not-allowed opacity-50":c}),"cmdk-input-wrapper":"",children:[N.jsx(I.Input,{ref:u,className:A("flex w-full rounded-md bg-background text-sm outline-none placeholder:text-muted-foreground",e),disabled:c,...a}),t]}));Re.displayName=I.Input.displayName;const Ce=l.forwardRef(({className:e,...n},t)=>N.jsx(I.List,{ref:t,className:A("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...n}));Ce.displayName=I.List.displayName;const Se=l.forwardRef(({className:e,...n},t)=>C(a=>a.filtered.count===0)?N.jsx("div",{ref:t,className:A("py-4 text-center text-sm",e),"cmdk-empty":"",role:"presentation",...n}):null);Se.displayName=I.Empty.displayName;const Ne=l.forwardRef(({className:e,...n},t)=>N.jsx(I.Group,{ref:t,className:A("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...n}));Ne.displayName=I.Group.displayName;const Ae=l.forwardRef(({className:e,...n},t)=>N.jsx(I.Separator,{ref:t,className:A("-mx-1 h-px bg-border",e),...n}));Ae.displayName=I.Separator.displayName;const Me=l.forwardRef(({className:e,...n},t)=>N.jsx(I.Item,{ref:t,className:A("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e),...n}));Me.displayName=I.Item.displayName;Ie.__docgenInfo={description:"",methods:[]};Re.__docgenInfo={description:"",methods:[],props:{wrapperClassName:{required:!1,tsType:{name:"string"},description:""},rightAddon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};Ce.__docgenInfo={description:"",methods:[]};Se.__docgenInfo={description:"The `CommandEmpty` of shadcn/ui will cause the cmdk empty not rendering correctly.\nSo we create one and copy the `Empty` implementation from `cmdk`.\n\n@reference: https://github.com/hsuanyi-chou/shadcn-ui-expansions/issues/34#issuecomment-1949561607",methods:[]};Ne.__docgenInfo={description:"",methods:[]};Me.__docgenInfo={description:"",methods:[]};Ae.__docgenInfo={description:"",methods:[]};function mt(e,n){const[t,c]=l.useState(e);return l.useEffect(()=>{const a=setTimeout(()=>c(e),n||500);return()=>{clearTimeout(a)}},[e,n]),t}function ft(e,n){let t;return(...c)=>(clearTimeout(t),new Promise(a=>{t=setTimeout(()=>{a(e(...c))},n)}))}export{Re as C,I as _,Ce as a,Ne as b,Me as c,Se as d,Ie as e,ft as f,mt as u};
