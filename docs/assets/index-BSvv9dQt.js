import{a as $t,H as re,O as oe,B as at,I as ie,M as ae,b as ce}from"./api-CkzL9HmQ.js";import{r as S,R as yt}from"./index-t5q4d8OJ.js";import{s as ue}from"./index-BNh7Aicb.js";class le{constructor(e={}){var n;this.apiKey=e.apiKey,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.serverIndex=e.serverIndex,this.baseOptions={...e.baseOptions,headers:{...(n=e.baseOptions)==null?void 0:n.headers}},this.formDataCtor=e.formDataCtor}isJsonMime(e){const n=new RegExp("^(application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(;.*)?$","i");return e!==null&&(n.test(e)||e.toLowerCase()==="application/json-patch+json")}}const H=$t.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});let Q=null;H.interceptors.response.use(t=>t,async t=>{const e=t.config;if(Q)return await Q,H(e);if(t.response.status===re.Unauthorized&&!e._retry){e._retry=!0;try{return Q=$t.post("/auth/refresh-token").finally(()=>{Q=null}),await Q,H(e)}catch(n){return window.location.href="/auth/logout",Promise.reject(n)}}return Promise.reject(t)});const ct=new le({basePath:"/api"});new ce(ct,at,H);const He=new oe(ct,at,H),ke=new ie(ct,at,H),$e=new ae(ct,at,H),Bt=0,Kt=1,zt=2,Wt=3;var Ut=Object.prototype.hasOwnProperty;function gt(t,e){var n,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&gt(t[s],e[s]););return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(Ut.call(t,n)&&++s&&!Ut.call(e,n)||!(n in e)||!gt(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}const N=new WeakMap,M=()=>{},C=M(),Ot=Object,a=t=>t===C,P=t=>typeof t=="function",W=(t,e)=>({...t,...e}),Jt=t=>P(t.then),pt={},ot={},At="undefined",tt=typeof window!=At,vt=typeof document!=At,fe=tt&&"Deno"in window,de=()=>tt&&typeof window.requestAnimationFrame!=At,Gt=(t,e)=>{const n=N.get(t);return[()=>!a(e)&&t.get(e)||pt,s=>{if(!a(e)){const c=t.get(e);e in ot||(ot[e]=c),n[5](e,W(c,s),c||pt)}},n[6],()=>!a(e)&&e in ot?ot[e]:!a(e)&&t.get(e)||pt]};let St=!0;const pe=()=>St,[Tt,Dt]=tt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[M,M],he=()=>{const t=vt&&document.visibilityState;return a(t)||t!=="hidden"},Ee=t=>(vt&&document.addEventListener("visibilitychange",t),Tt("focus",t),()=>{vt&&document.removeEventListener("visibilitychange",t),Dt("focus",t)}),Re=t=>{const e=()=>{St=!0,t()},n=()=>{St=!1};return Tt("online",e),Tt("offline",n),()=>{Dt("online",e),Dt("offline",n)}},we={isOnline:pe,isVisible:he},me={initFocus:Ee,initReconnect:Re},qt=!yt.useId,Z=!tt||fe,ge=t=>de()?window.requestAnimationFrame(t):setTimeout(t,1),ht=Z?S.useEffect:S.useLayoutEffect,Et=typeof navigator<"u"&&navigator.connection,Ht=!Z&&Et&&(["slow-2g","2g"].includes(Et.effectiveType)||Et.saveData),it=new WeakMap,Rt=(t,e)=>Ot.prototype.toString.call(t)===`[object ${e}]`;let Oe=0;const Ct=t=>{const e=typeof t,n=Rt(t,"Date"),s=Rt(t,"RegExp"),c=Rt(t,"Object");let r,i;if(Ot(t)===t&&!n&&!s){if(r=it.get(t),r)return r;if(r=++Oe+"~",it.set(t,r),Array.isArray(t)){for(r="@",i=0;i<t.length;i++)r+=Ct(t[i])+",";it.set(t,r)}if(c){r="#";const d=Ot.keys(t).sort();for(;!a(i=d.pop());)a(t[i])||(r+=i+":"+Ct(t[i])+",");it.set(t,r)}}else r=n?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return r},bt=t=>{if(P(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Ct(t):"",[t,e]};let ve=0;const _t=()=>++ve;async function Yt(...t){const[e,n,s,c]=t,r=W({populateCache:!0,throwOnError:!0},typeof c=="boolean"?{revalidate:c}:c||{});let i=r.populateCache;const d=r.rollbackOnError;let h=r.optimisticData;const A=T=>typeof d=="function"?d(T):d!==!1,g=r.throwOnError;if(P(n)){const T=n,E=[],L=e.keys();for(const w of L)!/^\$(inf|sub)\$/.test(w)&&T(e.get(w)._k)&&E.push(w);return Promise.all(E.map(R))}return R(n);async function R(T){const[E]=bt(T);if(!E)return;const[L,w]=Gt(e,E),[ut,o,et,Y]=N.get(e),F=()=>{const b=ut[E];return(P(r.revalidate)?r.revalidate(L().data,T):r.revalidate!==!1)&&(delete et[E],delete Y[E],b&&b[0])?b[0](zt).then(()=>L().data):L().data};if(t.length<3)return F();let O=s,_;const k=_t();o[E]=[k,0];const f=!a(h),$=L(),V=$.data,B=$._c,U=a(B)?V:B;if(f&&(h=P(h)?h(U,V):h,w({data:h,_c:U})),P(O))try{O=O(U)}catch(b){_=b}if(O&&Jt(O))if(O=await O.catch(b=>{_=b}),k!==o[E][0]){if(_)throw _;return O}else _&&f&&A(_)&&(i=!0,w({data:U,_c:C}));if(i&&!_)if(P(i)){const b=i(O,U);w({data:b,error:C,_c:C})}else w({data:O,error:C,_c:C});if(o[E][1]=_t(),Promise.resolve(F()).then(()=>{w({_c:C})}),_){if(g)throw _;return}return O}}const kt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},Se=(t,e)=>{if(!N.has(t)){const n=W(me,e),s=Object.create(null),c=Yt.bind(C,t);let r=M;const i=Object.create(null),d=(g,R)=>{const T=i[g]||[];return i[g]=T,T.push(R),()=>T.splice(T.indexOf(R),1)},h=(g,R,T)=>{t.set(g,R);const E=i[g];if(E)for(const L of E)L(R,T)},A=()=>{if(!N.has(t)&&(N.set(t,[s,Object.create(null),Object.create(null),Object.create(null),c,h,d]),!Z)){const g=n.initFocus(setTimeout.bind(C,kt.bind(C,s,Bt))),R=n.initReconnect(setTimeout.bind(C,kt.bind(C,s,Kt)));r=()=>{g&&g(),R&&R(),N.delete(t)}}};return A(),[t,c,A,r]}return[t,N.get(t)[4]]},Te=(t,e,n,s,c)=>{const r=n.errorRetryCount,i=c.retryCount,d=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!a(r)&&i>r||setTimeout(s,d,c)},De=gt,[Xt,Ce]=Se(new Map),_e=W({onLoadingSlow:M,onSuccess:M,onError:M,onErrorRetry:Te,onDiscarded:M,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ht?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Ht?5e3:3e3,compare:De,isPaused:()=>!1,cache:Xt,mutate:Ce,fallback:{}},we),ye=(t,e)=>{const n=W(t,e);if(e){const{use:s,fallback:c}=t,{use:r,fallback:i}=e;s&&r&&(n.use=s.concat(r)),c&&i&&(n.fallback=W(c,i))}return n},Ae=S.createContext({}),be="$inf$",Qt=tt&&window.__SWR_DEVTOOLS_USE__,Ie=Qt?window.__SWR_DEVTOOLS_USE__:[],Le=()=>{Qt&&(window.__SWR_DEVTOOLS_REACT__=yt)},Zt=t=>P(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Ve=()=>W(_e,S.useContext(Ae)),Pe=t=>(e,n,s)=>t(e,n&&((...r)=>{const[i]=bt(e),[,,,d]=N.get(Xt);if(i.startsWith(be))return n(...r);const h=d[i];return a(h)?n(...r):(delete d[i],h)}),s),je=Ie.concat(Pe),xe=t=>function(...n){const s=Ve(),[c,r,i]=Zt(n),d=ye(s,i);let h=t;const{use:A}=d,g=(A||[]).concat(je);for(let R=g.length;R--;)h=g[R](h);return h(c,r||d.fetcher||null,d)},Ne=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const c=s.indexOf(n);c>=0&&(s[c]=s[s.length-1],s.pop())}},Be=(t,e)=>(...n)=>{const[s,c,r]=Zt(n),i=(r.use||[]).concat(e);return t(s,c,{...r,use:i})};Le();const wt=yt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),mt={dedupe:!0},Fe=(t,e,n)=>{const{cache:s,compare:c,suspense:r,fallbackData:i,revalidateOnMount:d,revalidateIfStale:h,refreshInterval:A,refreshWhenHidden:g,refreshWhenOffline:R,keepPreviousData:T}=n,[E,L,w,ut]=N.get(s),[o,et]=bt(t),Y=S.useRef(!1),F=S.useRef(!1),O=S.useRef(o),_=S.useRef(e),k=S.useRef(n),f=()=>k.current,$=()=>f().isVisible()&&f().isOnline(),[V,B,U,b]=Gt(s,o),K=S.useRef({}).current,nt=a(i)?a(n.fallback)?C:n.fallback[o]:i,It=(l,u)=>{for(const v in K){const p=v;if(p==="data"){if(!c(l[p],u[p])&&(!a(l[p])||!c(rt,u[p])))return!1}else if(u[p]!==l[p])return!1}return!0},Lt=S.useMemo(()=>{const l=!o||!e?!1:a(d)?f().isPaused()||r?!1:h!==!1:d,u=D=>{const j=W(D);return delete j._k,l?{isValidating:!0,isLoading:!0,...j}:j},v=V(),p=b(),I=u(v),G=v===p?I:u(p);let m=I;return[()=>{const D=u(V());return It(D,m)?(m.data=D.data,m.isLoading=D.isLoading,m.isValidating=D.isValidating,m.error=D.error,m):(m=D,D)},()=>G]},[s,o]),z=ue.useSyncExternalStore(S.useCallback(l=>U(o,(u,v)=>{It(v,u)||l()}),[s,o]),Lt[0],Lt[1]),Vt=!Y.current,te=E[o]&&E[o].length>0,J=z.data,q=a(J)?nt&&Jt(nt)?wt(nt):nt:J,st=z.error,lt=S.useRef(q),rt=T?a(J)?a(lt.current)?q:lt.current:J:q,Pt=te&&!a(st)?!1:Vt&&!a(d)?d:f().isPaused()?!1:r?a(q)?!1:h:a(q)||h,jt=!!(o&&e&&Vt&&Pt),ee=a(z.isValidating)?jt:z.isValidating,ne=a(z.isLoading)?jt:z.isLoading,X=S.useCallback(async l=>{const u=_.current;if(!o||!u||F.current||f().isPaused())return!1;let v,p,I=!0;const G=l||{},m=!w[o]||!G.dedupe,D=()=>qt?!F.current&&o===O.current&&Y.current:o===O.current,j={isValidating:!1,isLoading:!1},Nt=()=>{B(j)},Ft=()=>{const y=w[o];y&&y[1]===p&&delete w[o]},Mt={isValidating:!0};a(V().data)&&(Mt.isLoading=!0);try{if(m&&(B(Mt),n.loadingTimeout&&a(V().data)&&setTimeout(()=>{I&&D()&&f().onLoadingSlow(o,n)},n.loadingTimeout),w[o]=[u(et),_t()]),[v,p]=w[o],v=await v,m&&setTimeout(Ft,n.dedupingInterval),!w[o]||w[o][1]!==p)return m&&D()&&f().onDiscarded(o),!1;j.error=C;const y=L[o];if(!a(y)&&(p<=y[0]||p<=y[1]||y[1]===0))return Nt(),m&&D()&&f().onDiscarded(o),!1;const x=V().data;j.data=c(x,v)?x:v,m&&D()&&f().onSuccess(v,o,n)}catch(y){Ft();const x=f(),{shouldRetryOnError:ft}=x;x.isPaused()||(j.error=y,m&&D()&&(x.onError(y,o,x),(ft===!0||P(ft)&&ft(y))&&(!f().revalidateOnFocus||!f().revalidateOnReconnect||$())&&x.onErrorRetry(y,o,x,se=>{const dt=E[o];dt&&dt[0]&&dt[0](Wt,se)},{retryCount:(G.retryCount||0)+1,dedupe:!0})))}return I=!1,Nt(),!0},[o,s]),xt=S.useCallback((...l)=>Yt(s,O.current,...l),[]);if(ht(()=>{_.current=e,k.current=n,a(J)||(lt.current=J)}),ht(()=>{if(!o)return;const l=X.bind(C,mt);let u=0;f().revalidateOnFocus&&(u=Date.now()+f().focusThrottleInterval);const p=Ne(o,E,(I,G={})=>{if(I==Bt){const m=Date.now();f().revalidateOnFocus&&m>u&&$()&&(u=m+f().focusThrottleInterval,l())}else if(I==Kt)f().revalidateOnReconnect&&$()&&l();else{if(I==zt)return X();if(I==Wt)return X(G)}});return F.current=!1,O.current=o,Y.current=!0,B({_k:et}),Pt&&(a(q)||Z?l():ge(l)),()=>{F.current=!0,p()}},[o]),ht(()=>{let l;function u(){const p=P(A)?A(V().data):A;p&&l!==-1&&(l=setTimeout(v,p))}function v(){!V().error&&(g||f().isVisible())&&(R||f().isOnline())?X(mt).then(u):u()}return u(),()=>{l&&(clearTimeout(l),l=-1)}},[A,g,R,o]),S.useDebugValue(rt),r&&a(q)&&o){if(!qt&&Z)throw new Error("Fallback data is required when using Suspense in SSR.");_.current=e,k.current=n,F.current=!1;const l=ut[o];if(!a(l)){const u=xt(l);wt(u)}if(a(st)){const u=X(mt);a(rt)||(u.status="fulfilled",u.value=!0),wt(u)}else throw st}return{mutate:xt,get data(){return K.data=!0,rt},get error(){return K.error=!0,st},get isValidating(){return K.isValidating=!0,ee},get isLoading(){return K.isLoading=!0,ne}}},Ke=xe(Fe);export{qt as I,C as U,Ve as a,W as b,ht as c,_t as g,ke as i,$e as m,He as o,bt as s,Ke as u,Be as w};
