import{j as l}from"./jsx-runtime-D_zvdyIk.js";import{r as i}from"./index-DUAV1Q2A.js";import{f as pe}from"./index-DhvbgntC.js";import{a as W}from"./index-B-lxVbXh.js";import{u as ve,d as he,e as be,_ as ge,a as we,c as G,b as xe}from"./useDebounce-DAsjOoms.js";import{B as ye}from"./badge-CBy4Ctlv.js";import{c as j}from"./utils-BNf5BS2b.js";import{S as Ne}from"./skeleton-D8I-6WeW.js";import{X as Re}from"./x-CWrtXjNM.js";import{C as je}from"./check-D0WsHlur.js";import"./v4-CtRu48qb.js";import"./index-B_Tq-F3N.js";import"./index-CpwtQhPK.js";import"./index-CSO_qfi8.js";import"./index-CqVsPxxY.js";import"./Combination-BychJT1d.js";import"./index-DgC28C5k.js";import"./dialog-8K1hlcAL.js";import"./index-C66Dxnp2.js";import"./createLucideIcon-DirO1-NP.js";function M(c,r){if(c.length===0)return{};if(!r)return{"":c};const o={};return c.forEach(m=>{const p=m[r]||"";o[p]||(o[p]=[]),o[p].push(m)}),o}function Q(c,r){return r.filter(o=>c.includes(o.value))}function Oe(c,r){for(const[,o]of Object.entries(c))if(o.some(m=>r.find(p=>p.value===m.value)))return!0;return!1}function k({value:c,onChange:r,placeholder:o,defaultOptions:m=[],options:p,debounceDelay:re=500,onSearch:f,onSearchSync:E,emptyIndicator:z,maxSelected:B=Number.MAX_SAFE_INTEGER,onMaxSelected:x,hidePlaceholderWhenSelected:K,disabled:O,groupBy:b,className:se,selectFirstItem:ne=!0,creatable:S=!1,triggerSearchOnFocus:C=!1,commandProps:n,inputProps:u,hideClearAllButton:ie=!1,renderBadge:X,ref:ue}){const d=i.useRef(null),[g,A]=i.useState(!1),[oe,H]=i.useState(!1),[J,U]=i.useState(!1),L=i.useRef(null),[a,y]=i.useState(Q(c||[],m)),[N,F]=i.useState(M(m,b)),[h,D]=i.useState(""),w=ve(h,re);i.useImperativeHandle(ue,()=>({selectedValue:[...a],input:d.current,focus:()=>{var e;return(e=d==null?void 0:d.current)==null?void 0:e.focus()},reset:()=>y([])}),[a]);const R=e=>{L.current&&!L.current.contains(e.target)&&d.current&&!d.current.contains(e.target)&&(A(!1),d.current.blur())},V=i.useCallback(e=>{const t=a.filter(s=>s.value!==e.value);y(t),r==null||r(t.map(s=>s.value))},[r,a]),ce=i.useCallback(e=>{const t=d.current;t&&((e.key==="Delete"||e.key==="Backspace")&&t.value===""&&a.length>0&&(a[a.length-1].fixed||V(a[a.length-1])),e.key==="Escape"&&t.blur())},[V,a]);i.useEffect(()=>(g?(document.addEventListener("mousedown",R),document.addEventListener("touchend",R)):(document.removeEventListener("mousedown",R),document.removeEventListener("touchend",R)),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("touchend",R)}),[g]),i.useEffect(()=>{c&&m.length>0&&y(Q(c,m))},[c,m]),i.useEffect(()=>{if(!p||f)return;const e=M(p||[],b);JSON.stringify(e)!==JSON.stringify(N)&&F(e)},[m,p,b,f,N]),i.useEffect(()=>{const e=()=>{const s=E==null?void 0:E(w);F(M(s||[],b))};(async()=>{!E||!g||(C&&e(),w&&e())})()},[w,b,g,C]),i.useEffect(()=>{const e=async()=>{U(!0);const s=await(f==null?void 0:f(w));F(M(s||[],b)),U(!1)};(async()=>{!f||!g||(C&&await e(),w&&await e())})()},[w,b,g,C]);const de=()=>{if(!S||Oe(N,[{value:h,label:h}])||a.find(t=>t.value===h))return;const e=l.jsx(G,{value:h,className:"cursor-pointer",onMouseDown:t=>{t.preventDefault(),t.stopPropagation()},onSelect:t=>{if(a.length>=B){x==null||x(a.length);return}D("");const s=[...a,{value:t,label:t}];y(s),r==null||r(s.map(_=>_.value))},children:`Create "${h}"`});if(!f&&h.length>0||f&&w.length>0&&!J)return e},me=i.useCallback(()=>f&&!S&&Object.keys(N).length===0?l.jsx("div",{className:"p-2 py-4 text-center text-sm",children:"No data"}):l.jsx(he,{children:z||l.jsx("div",{className:"text-center text-sm",children:"No data"})}),[S,z,f,N]),fe=i.useCallback(()=>{if(n!=null&&n.filter)return n.filter;if(S)return(e,t)=>e.toLowerCase().includes(t.toLowerCase())?1:-1},[S,n==null?void 0:n.filter]);return l.jsxs(be,{ref:L,...n,onKeyDown:e=>{var t;ce(e),(t=n==null?void 0:n.onKeyDown)==null||t.call(n,e)},className:j("h-auto overflow-visible bg-background",n==null?void 0:n.className),shouldFilter:(n==null?void 0:n.shouldFilter)!==void 0?n.shouldFilter:!f,filter:fe(),children:[l.jsxs("div",{className:j("flex min-h-10 rounded-md border border-input text-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring",{"px-3 py-2":a.length!==0,"cursor-text":!O&&a.length!==0},se),onClick:()=>{var e;O||(e=d==null?void 0:d.current)==null||e.focus()},children:[l.jsxs("div",{className:"relative flex flex-1 flex-wrap gap-1",children:[a.map(e=>X?X({option:e,onRemove:()=>V(e)}):l.jsx(ye,{color:"primary",variant:"filled","data-disabled":O||void 0,onClose:()=>V(e),children:e.label},e.value)),l.jsx(ge.Input,{...u,ref:d,value:h,disabled:O,onValueChange:e=>{var t;D(e),(t=u==null?void 0:u.onValueChange)==null||t.call(u,e)},onBlur:e=>{var t;oe||A(!1),(t=u==null?void 0:u.onBlur)==null||t.call(u,e)},onFocus:e=>{var t;A(!0),(t=u==null?void 0:u.onFocus)==null||t.call(u,e)},placeholder:K&&a.length!==0?"":o,className:j("flex-1 bg-transparent outline-none placeholder:text-muted-foreground",{"w-full":K,"px-3 py-2":a.length===0,"ml-1":a.length!==0},u==null?void 0:u.className)})]}),l.jsx("button",{type:"button",onClick:()=>{y(a.filter(e=>e.fixed)),r==null||r(a.filter(e=>e.fixed).map(e=>e.value))},className:j((ie||O||a.length<1||a.filter(e=>e.fixed).length===a.length)&&"hidden"),children:l.jsx(Re,{size:18,className:""})})]}),l.jsx("div",{className:j("relative",g?"block":"hidden"),children:l.jsx(we,{className:"absolute top-1 z-10 w-full rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in fade-in-0 zoom-in-95",onMouseLeave:()=>{H(!1)},onMouseEnter:()=>{H(!0)},onMouseUp:()=>{var e;(e=d==null?void 0:d.current)==null||e.focus()},children:J?l.jsx("div",{className:"p-1",children:l.jsx(Ne,{className:"h-8 w-full"})}):l.jsxs(l.Fragment,{children:[me(),de(),!ne&&l.jsx(G,{value:"-",className:"hidden"}),Object.entries(N).map(([e,t])=>l.jsx(xe,{heading:e,className:"h-full overflow-auto",children:l.jsx(l.Fragment,{children:t.map(s=>{var $;const _=($=a.map(v=>v.value))==null?void 0:$.includes(s.value);return l.jsxs(G,{value:s.label,disabled:s.disable,onMouseDown:v=>{v.preventDefault(),v.stopPropagation()},onSelect:()=>{if(a.length>=B){x==null||x(a.length);return}D("");let v=[];a.find(T=>T.value===s.value)?v=a.filter(T=>T.value!==s.value):v=[...a,s],y(v),r==null||r(v.map(T=>T.value))},className:j("cursor-pointer",s.disable&&"cursor-default text-muted-foreground"),children:[l.jsx("span",{className:"flex-1",children:s.label}),_?l.jsx(je,{className:"w-4"}):null]},s.value)})})},e))]})})})]})}k.displayName="MultipleSelector";k.__docgenInfo={description:"",methods:[{name:"focus",docblock:null,modifiers:[],params:[],returns:null},{name:"reset",docblock:null,modifiers:[],params:[],returns:null}],displayName:"MultipleSelector",props:{ref:{required:!1,tsType:{name:"union",raw:"React.RefCallback<MultipleSelectorRef> | React.RefObject<MultipleSelectorRef>",elements:[{name:"ReactRefCallback",raw:"React.RefCallback<MultipleSelectorRef>",elements:[{name:"MultipleSelectorRef"}]},{name:"ReactRefObject",raw:"React.RefObject<MultipleSelectorRef>",elements:[{name:"MultipleSelectorRef"}]}]},description:""},value:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},defaultOptions:{required:!1,tsType:{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"},description:"",defaultValue:{value:"[]",computed:!1}},options:{required:!1,tsType:{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"},description:"manually controlled options"},placeholder:{required:!1,tsType:{name:"string"},description:""},emptyIndicator:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Empty component."},debounceDelay:{required:!1,tsType:{name:"number"},description:"Debounce time for async search. Only work with `onSearch`.",defaultValue:{value:"500",computed:!1}},triggerSearchOnFocus:{required:!1,tsType:{name:"boolean"},description:"Only work with `onSearch` prop. Trigger search when `onFocus`.\nFor example, when user click on the input, it will trigger the search to get initial options.",defaultValue:{value:"false",computed:!1}},onSearch:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => Promise<MultiSelectorOption[]>",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Promise",elements:[{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"}],raw:"Promise<MultiSelectorOption[]>"}}},description:"async search"},onSearchSync:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => MultiSelectorOption[]",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"Array",elements:[{name:"MultiSelectorOption"}],raw:"MultiSelectorOption[]"}}},description:`sync search. This search will not showing loadingIndicator.
The rest props are the same as async search.
i.e.: creatable, groupBy, delay.`},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(options: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"options"}],return:{name:"void"}}},description:""},maxSelected:{required:!1,tsType:{name:"number"},description:"Limit the maximum number of selected options.",defaultValue:{value:"Number.MAX_SAFE_INTEGER",computed:!0}},onMaxSelected:{required:!1,tsType:{name:"signature",type:"function",raw:"(maxLimit: number) => void",signature:{arguments:[{type:{name:"number"},name:"maxLimit"}],return:{name:"void"}}},description:"When the number of selected options exceeds the limit, the onMaxSelected will be called."},hidePlaceholderWhenSelected:{required:!1,tsType:{name:"boolean"},description:"Hide the placeholder when there are options selected."},disabled:{required:!1,tsType:{name:"boolean"},description:""},groupBy:{required:!1,tsType:{name:"string"},description:"Group the options base on provided key."},className:{required:!1,tsType:{name:"string"},description:""},selectFirstItem:{required:!1,tsType:{name:"boolean"},description:`First item selected is a default behavior by cmdk. That is why the default is true.
This is a workaround solution by add a dummy item.

@reference: https://github.com/pacocoursey/cmdk/issues/171`,defaultValue:{value:"true",computed:!1}},creatable:{required:!1,tsType:{name:"boolean"},description:"Allow user to create option when there is no option matched.",defaultValue:{value:"false",computed:!1}},commandProps:{required:!1,tsType:{name:"ReactComponentPropsWithoutRef",raw:"React.ComponentPropsWithoutRef<typeof Command>",elements:[{name:"Command"}]},description:"Props of `Command`"},inputProps:{required:!1,tsType:{name:"Omit",elements:[{name:"ReactComponentPropsWithoutRef",raw:"React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>",elements:[{name:"CommandPrimitive.Input"}]},{name:"union",raw:"'value' | 'placeholder' | 'disabled'",elements:[{name:"literal",value:"'value'"},{name:"literal",value:"'placeholder'"},{name:"literal",value:"'disabled'"}]}],raw:`Omit<
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>,
  'value' | 'placeholder' | 'disabled'
>`},description:"Props of `CommandInput`"},hideClearAllButton:{required:!1,tsType:{name:"boolean"},description:"hide the clear all button.",defaultValue:{value:"false",computed:!1}},renderBadge:{required:!1,tsType:{name:"signature",type:"function",raw:"(params: { option: MultiSelectorOption; onRemove: () => void }) => React.ReactNode",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ option: MultiSelectorOption; onRemove: () => void }",signature:{properties:[{key:"option",value:{name:"MultiSelectorOption",required:!0}},{key:"onRemove",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}}]}},name:"params"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:"Render the badge for each option."}}};const He={title:"Base/Data Entry/Inputs/Multi Selector",component:k,args:{value:[],onChange:pe(),placeholder:"Placeholder"}},le=[{label:"Nextjs",value:"Nextjs"},{label:"Vite",value:"vite"},{label:"Nuxt",value:"nuxt",disable:!0},{label:"Vue",value:"vue, disable: true",disable:!0},{label:"Remix",value:"remix"},{label:"Svelte",value:"svelte",disable:!0},{label:"Angular",value:"angular",disable:!0},{label:"Ember",value:"ember",disable:!0},{label:"React",value:"react"},{label:"Gatsby",value:"gatsby",disable:!0},{label:"Astro",value:"astro",disable:!0}],q={render:()=>{const[c,r]=i.useState(["Nextjs"]);return l.jsx(k,{value:c,onChange:o=>{r(o),W("onChange")(o)},className:"max-w-[300px]",placeholder:"Placeholder",commandProps:{className:"max-w-[300px]"},defaultOptions:le})}},I={render:()=>{const[c,r]=i.useState(["Nextjs"]);return l.jsx(k,{value:c,onChange:o=>{r(o),W("onChange")(o)},onSearch:async o=>(W("onSearch")(o),new Promise(m=>{setTimeout(()=>m(le),1e3)})),debounceDelay:300,className:"max-w-[300px]",placeholder:"Placeholder",commandProps:{className:"max-w-[300px]"}})}};var Y,Z,P;q.parameters={...q.parameters,docs:{...(Y=q.parameters)==null?void 0:Y.docs,source:{originalSource:`{
  render: () => {
    const [values, setValues] = useState<string[]>(['Nextjs']);
    return <MultiSelector value={values} onChange={newValues => {
      setValues(newValues);
      action('onChange')(newValues);
    }} className="max-w-[300px]" placeholder="Placeholder" commandProps={{
      className: 'max-w-[300px]'
    }} defaultOptions={defaultOptions} />;
  }
}`,...(P=(Z=q.parameters)==null?void 0:Z.docs)==null?void 0:P.source}}};var ee,te,ae;I.parameters={...I.parameters,docs:{...(ee=I.parameters)==null?void 0:ee.docs,source:{originalSource:`{
  render: () => {
    const [values, setValues] = useState<string[]>(['Nextjs']);
    return <MultiSelector value={values} onChange={newValues => {
      setValues(newValues);
      action('onChange')(newValues);
    }} onSearch={async searchValue => {
      action('onSearch')(searchValue);
      return new Promise(resolve => {
        setTimeout(() => resolve(defaultOptions), 1000);
      });
    }} debounceDelay={300} className="max-w-[300px]" placeholder="Placeholder" commandProps={{
      className: 'max-w-[300px]'
    }} />;
  }
}`,...(ae=(te=I.parameters)==null?void 0:te.docs)==null?void 0:ae.source}}};const Je=["Default","AsyncSearch"];export{I as AsyncSearch,q as Default,Je as __namedExportsOrder,He as default};
